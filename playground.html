<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Sass.js - emscripted libsass in the browser</title>
  <style>
    textarea {
      float: left;
      width: 40%;
      height: 200px;
    }

    #credits {
      clear: left;
      padding-top: 10px;
    }
    
    #options {
      padding: 20px;
      background: #DDD;
      -webkit-columns: 2;
      -webkit-column-rule: 1px solid white;
      -webkit-column-gap: 15px;
    }
    .option {
      position: relative;
      padding: 10px 0;
    }
    .option label {
      display: inline-block;
      width: 150px;
      text-align: right;

    }
    .option label:after {
      content: ": ";
    }
    .option input,
    .option select {
      margin-left: 10px;
    }
    .option .comment {
      display: block;
      color: #666;
    }
    .option .comment:before {
      content: '/* ';
    }
    .option .comment:after {
      content: ' */';
    }
    
  </style>
</head>
<body>
  <h1>Sass.js - Convert Sass in the browser using Emscripten &amp; Libsass</h1>
  <p>
    More information in the <a href="https://github.com/medialize/sass.js/">Sass.js repository</a>.
  </p>

  <article id="options">
    
    <section class="option">
      <span class="comment">See <a href="http://sass-lang.com/documentation/file.SASS_REFERENCE.html#output_style">documentation</a></span>
      <label for="options-style">style</label>
      <select id="option-style">
        <option value="0">nested</option>
        <option value="1">expanded</option>
        <option value="2">compact</option>
        <option value="3">compressed</option>
      </select>
    </section>

    <section class="option">
      <span class="comment">Emit comments in the generated CSS indicating the corresponding source line.</span>
      <label for="option-comments">comments</label>
      <select id="option-comments">
        <option value="">none</option>
        <option value="1">default</option>
      </select>
    </section>
    
    <section class="option">
      <span class="comment">Precision for fractional numbers (<code>0</code>: libsass default)</span>
      <label for="option-precision">precision</label>
      <input id="option-precision" type="number" min="0" step="1" value="0">
    </section>
    
    <section class="option">
      <span class="comment">Treat source_string as SASS (as opposed to SCSS)</span>
      <label for="option-indentedSyntax">indentedSyntax</label>
      <select id="option-indentedSyntax">
        <option value="" selected>false (SCSS)</option>
        <option value="1">true (SASS)</option>
      </select>
    </section>

    <section class="option">
      <span class="comment">String to be used for indentation</span>
      <label for="option-indent">indent</label>
      <select id="option-indent">
        <option value="  " selected>2 Spaces</option>
        <option value="    ">4 Spaces</option>
        <option value="	">Tab</option>
      </select>
    </section>

    <section class="option">
      <span class="comment">String to be used to for line feeds</span>
      <label for="option-linefeed">linefeed</label>
      <select id="option-linefeed">
        <option value="\n" selected>\n</option>
        <option value="\r\n">\r\n</option>
      </select>
    </section>

    <section class="option">
      <span class="comment">Path to source map file. Enables source map generation. Used to create sourceMappingUrl</span>
      <label for="option-sourceMapFile">sourceMapFile</label>
      <input id="option-sourceMapFile" type="text" value="file">
    </section>

    <section class="option">
      <span class="comment">Directly inserted in source maps</span>
      <label for="option-sourceMapRoot">sourceMapRoot</label>
      <input id="option-sourceMapRoot" type="text" value="root">
    </section>

    <section class="option">
      <span class="comment">The input path is used for source map generation. It can be used to define something with string compilation or to overload the input file path. It is set to <code>stdin</code> for data contexts and to the <var>input file</var> on file contexts.</span>
      <label for="option-inputPath">inputPath</label>
      <input id="option-inputPath" type="text" value="stdin">
    </section>

    <section class="option">
      <span class="comment">The output path is used for source map generation. Libsass will not write to this file, it is just used to create information in source-maps etc.</span>
      <label for="option-outputPath">outputPath</label>
      <input id="option-outputPath" type="text" value="stdout">
    </section>

    <section class="option">
      <span class="comment">Embed include contents in source maps</span>
      <label for="option-sourceMapContents">sourceMapContents</label>
      <select id="option-sourceMapContents">
        <option value="">false</option>
        <option value="1" selected>true</option>
      </select>
    </section>

    <section class="option">
      <span class="comment">Embed sourceMappingUrl as data URI</span>
      <label for="option-sourceMapEmbed">sourceMapEmbed</label>
      <select id="option-sourceMapEmbed">
        <option value="">false</option>
        <option value="1" selected>true</option>
      </select>
    </section>

    <section class="option">
      <span class="comment">Disable sourceMappingUrl in CSS output</span>
      <label for="option-sourceMapOmitUrl">sourceMapOmitUrl</label>
      <select id="option-sourceMapOmitUrl">
        <option value="">false</option>
        <option value="1" selected>true</option>
      </select>
    </section>

  </article>

  <p><button type="button" id="convert">Convert</button></p>

  <textarea id="input">@import "demo";
$foo: 10px;
.selector {
  margin: $foo;
  .nested {
    margin: $foo / 2;
  }
}</textarea>
  <textarea id="output"></textarea>

  <p id="credits">
   This fun was had by <a href="https://twitter.com/cjk101010">@cjk101010</a>, <a href="https://twitter.com/asciidisco">@asciidisco</a> and <a href="https://twitter.com/rodneyrehm">@rodneyrehm</a>.
  </p>

  <script src="dist/sass.worker.js"></script>
  <script>
    Sass.initialize('dist/worker.min.js');
    Sass.writeFile('demo.scss', '.imported { content: "yeah, file support!"; }');

    var convert = document.getElementById('convert');
    var input = document.getElementById('input');
    var output = document.getElementById('output');

    convert.addEventListener('click', function (event) {
      event.preventDefault();
      convert.disabled = false;
      Sass.options(getOptions(), function() {
        Sass.compile(input.value, function (result) {
          if (typeof result.text !== 'string') {
            output.value = 'Error on line ' + result.line + ':\n' + result.message;
          } else {
            output.value = result.text;
          }

          console.log('files', result.files);
          console.log('map', result.map);
        });
      })
    }, false);
    
    function getOptions() {
      var options = {};
      var elements = document.querySelectorAll('#options input, #options select');
      [].forEach.call(elements, function(element) {
        if (element.id.slice(0, 7) !== 'option-') {
          return;
        }

        var key = element.id.slice(7);
        options[key] = element.value;
      });

      // fix line breaks
      options.linefeed = ({
        '\\n': '\n',
        '\\r\\n': '\r\n',
      })[options.linefeed]

      return options;
    }
    
  </script>
</body>
</html>